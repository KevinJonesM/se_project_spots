/******/ (() => { // webpackBootstrap
/******/ 	"use strict";

;// ./src/scripts/validation.js
function enableValidation(config) {
  var forms = document.querySelectorAll(config.formSelector);
  forms.forEach(function (form) {
    setEventListeners(form, config);
  });
}
function setEventListeners(form, config) {
  var inputs = form.querySelectorAll(config.inputSelector);
  var submitButton = form.querySelector(config.submitButtonSelector);
  toggleButtonState(inputs, submitButton, config);
  inputs.forEach(function (input) {
    input.addEventListener("input", function () {
      validateInput(input, config);
      toggleButtonState(inputs, submitButton, config);
    });
  });
}
function validateInput(input, config) {
  var errorElement = input.closest("label").querySelector(config.errorSelector);
  if (!input.validity.valid) {
    showInputError(input, errorElement, config);
  } else {
    hideInputError(input, config);
  }
}
function showInputError(input, errorElement, config) {
  errorElement.textContent = input.validationMessage;
  errorElement.classList.add(config.errorClass);
}
function hideInputError(input, config) {
  var errorElement = input.closest("label").querySelector(config.errorSelector);
  errorElement.textContent = "";
  errorElement.classList.remove(config.errorClass);
}
function toggleButtonState(inputs, button, config) {
  var isValid = Array.from(inputs).every(function (input) {
    return input.validity.valid;
  });
  if (isValid) {
    button.classList.remove(config.inactiveButtonClass);
    button.disabled = false;
  } else {
    button.classList.add(config.inactiveButtonClass);
    button.disabled = true;
  }
}
function resetValidation(form, config) {
  var inputs = form.querySelectorAll(config.inputSelector);
  inputs.forEach(function (input) {
    return hideInputError(input, config);
  });
  toggleButtonState(inputs, form.querySelector(config.submitButtonSelector), config);
}
;// ./src/pages/index.js
function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }
function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _iterableToArray(r) { if ("undefined" != typeof Symbol && null != r[Symbol.iterator] || null != r["@@iterator"]) return Array.from(r); }
function _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }


document.addEventListener("DOMContentLoaded", function () {
  var validationConfig = {
    formSelector: "form",
    inputSelector: ".modal__input",
    submitButtonSelector: ".modal__submit-btn",
    inactiveButtonClass: "modal__submit-btn_disabled",
    errorClass: "modal__error_visible",
    errorSelector: ".modal__error"
  };
  enableValidation(validationConfig);
  var initialCards = [{
    name: "Val Thorens",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"
  }, {
    name: "Restaurant terrace",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"
  }, {
    name: "An outdoor cafe",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"
  }, {
    name: "A very long bridge, over the forest and through the trees",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"
  }, {
    name: "Tunnel with morning light",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"
  }, {
    name: "Mountain house",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"
  }, {
    name: "Golden Gate bridge",
    link: "https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"
  }];
  var editProfileButton = document.querySelector(".profile__edit-btn");
  var addCardButton = document.querySelector(".profile__add-btn");
  var editModal = document.querySelector("#edit-profile-modal");
  var addCardModal = document.querySelector("#add-card-modal");
  var editForm = editModal === null || editModal === void 0 ? void 0 : editModal.querySelector("form");
  var addCardForm = addCardModal === null || addCardModal === void 0 ? void 0 : addCardModal.querySelector("form");
  var profileNameElement = document.querySelector(".profile__name");
  var profileDescriptionElement = document.querySelector(".profile__description");
  var editNameInput = document.querySelector("#profile-name-input");
  var editDescriptionInput = document.querySelector("#profile-description-input");
  var cardNameInput = document.querySelector("#add-card-caption-input");
  var cardLinkInput = document.querySelector("#add-card-link-input");
  var cardTemplate = document.querySelector("#card-template");
  var cardList = document.querySelector(".cards__list");
  var previewModal = document.querySelector("#preview-modal");
  var previewImage = previewModal === null || previewModal === void 0 ? void 0 : previewModal.querySelector(".modal__image");
  var previewCaption = previewModal === null || previewModal === void 0 ? void 0 : previewModal.querySelector(".modal__caption");
  function openModal(modal) {
    if (modal) {
      modal.classList.add("modal_opened");
      document.addEventListener("keydown", handleEscapeKey);
    }
  }
  function closeModal(modal) {
    if (modal) {
      modal.classList.remove("modal_opened");
      document.removeEventListener("keydown", handleEscapeKey);
    }
  }
  function handleEscapeKey(event) {
    if (event.key === "Escape") {
      var openedModal = document.querySelector(".modal_opened");
      if (openedModal) closeModal(openedModal);
    }
  }
  document.querySelectorAll(".modal__close-btn").forEach(function (button) {
    var modal = button.closest(".modal");
    if (modal) {
      button.addEventListener("click", function () {
        return closeModal(modal);
      });
    }
  });
  document.querySelectorAll(".modal").forEach(function (modal) {
    modal.addEventListener("mousedown", function (event) {
      if (event.target === modal) {
        closeModal(modal);
      }
    });
  });
  function getCardElement(data) {
    if (!data.name || !data.link) {
      return null;
    }
    var cardElement = cardTemplate.content.querySelector(".card").cloneNode(true);
    var cardImage = cardElement.querySelector(".card__image");
    var cardTitle = cardElement.querySelector(".card__title");
    var cardlikeBtn = cardElement.querySelector(".card__like-btn");
    var cardDeleteBtn = cardElement.querySelector(".card__delete-btn");
    cardImage.src = data.link;
    cardImage.alt = data.name;
    cardTitle.textContent = data.name;
    cardImage.addEventListener("click", function () {
      if (previewModal && previewImage && previewCaption) {
        previewImage.src = data.link;
        previewImage.alt = data.name;
        previewCaption.textContent = data.name;
        openModal(previewModal);
      }
    });
    cardlikeBtn.addEventListener("click", function () {
      cardlikeBtn.classList.toggle("card__like-button_liked");
    });
    cardDeleteBtn.addEventListener("click", function () {
      cardElement.remove();
    });
    return cardElement;
  }
  function loadInitialCards() {
    var existingImages = new Set(_toConsumableArray(cardList.querySelectorAll(".card__image")).map(function (img) {
      return img.src;
    }));
    initialCards.forEach(function (card) {
      if (!existingImages.has(card.link)) {
        var cardElement = getCardElement(card);
        if (cardElement) cardList.prepend(cardElement);
      }
    });
  }
  loadInitialCards();
  addCardForm.addEventListener("submit", function (evt) {
    evt.preventDefault();
    var name = cardNameInput.value.trim();
    var link = cardLinkInput.value.trim();
    if (!name || !link) {
      return;
    }
    var cardData = {
      name: name,
      link: link
    };
    var cardElement = getCardElement(cardData);
    if (cardElement) {
      cardList.prepend(cardElement);
    }
    addCardForm.reset();
    resetValidation(addCardForm, validationConfig);
    toggleButtonState(addCardForm.querySelectorAll(validationConfig.inputSelector), addCardForm.querySelector(validationConfig.submitButtonSelector), validationConfig);
    closeModal(addCardModal);
  });
  if (editProfileButton && editModal) {
    editProfileButton.addEventListener("click", function () {
      editNameInput.value = profileNameElement.textContent;
      editDescriptionInput.value = profileDescriptionElement.textContent;
      resetValidation(editForm, validationConfig);
      openModal(editModal);
    });
  }
  if (editForm) {
    editForm.addEventListener("submit", function (evt) {
      evt.preventDefault();
      profileNameElement.textContent = editNameInput.value.trim();
      profileDescriptionElement.textContent = editDescriptionInput.value.trim();
      closeModal(editModal);
    });
  }
  if (addCardButton && addCardModal) {
    addCardButton.addEventListener("click", function () {
      resetValidation(addCardForm, validationConfig);
      openModal(addCardModal);
    });
  }
});
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPLFNBQVNBLGdCQUFnQkEsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3ZDLElBQU1DLEtBQUssR0FBR0MsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQ0gsTUFBTSxDQUFDSSxZQUFZLENBQUM7RUFDNURILEtBQUssQ0FBQ0ksT0FBTyxDQUFDLFVBQUNDLElBQUksRUFBSztJQUN0QkMsaUJBQWlCLENBQUNELElBQUksRUFBRU4sTUFBTSxDQUFDO0VBQ2pDLENBQUMsQ0FBQztBQUNKO0FBRUEsU0FBU08saUJBQWlCQSxDQUFDRCxJQUFJLEVBQUVOLE1BQU0sRUFBRTtFQUN2QyxJQUFNUSxNQUFNLEdBQUdGLElBQUksQ0FBQ0gsZ0JBQWdCLENBQUNILE1BQU0sQ0FBQ1MsYUFBYSxDQUFDO0VBQzFELElBQU1DLFlBQVksR0FBR0osSUFBSSxDQUFDSyxhQUFhLENBQUNYLE1BQU0sQ0FBQ1ksb0JBQW9CLENBQUM7RUFDcEVDLGlCQUFpQixDQUFDTCxNQUFNLEVBQUVFLFlBQVksRUFBRVYsTUFBTSxDQUFDO0VBQy9DUSxNQUFNLENBQUNILE9BQU8sQ0FBQyxVQUFDUyxLQUFLLEVBQUs7SUFDeEJBLEtBQUssQ0FBQ0MsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07TUFDcENDLGFBQWEsQ0FBQ0YsS0FBSyxFQUFFZCxNQUFNLENBQUM7TUFDNUJhLGlCQUFpQixDQUFDTCxNQUFNLEVBQUVFLFlBQVksRUFBRVYsTUFBTSxDQUFDO0lBQ2pELENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKO0FBRUEsU0FBU2dCLGFBQWFBLENBQUNGLEtBQUssRUFBRWQsTUFBTSxFQUFFO0VBQ3BDLElBQU1pQixZQUFZLEdBQUdILEtBQUssQ0FBQ0ksT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDUCxhQUFhLENBQUNYLE1BQU0sQ0FBQ21CLGFBQWEsQ0FBQztFQUMvRSxJQUFJLENBQUNMLEtBQUssQ0FBQ00sUUFBUSxDQUFDQyxLQUFLLEVBQUU7SUFDekJDLGNBQWMsQ0FBQ1IsS0FBSyxFQUFFRyxZQUFZLEVBQUVqQixNQUFNLENBQUM7RUFDN0MsQ0FBQyxNQUFNO0lBQ0x1QixjQUFjLENBQUNULEtBQUssRUFBRWQsTUFBTSxDQUFDO0VBQy9CO0FBQ0Y7QUFFQSxTQUFTc0IsY0FBY0EsQ0FBQ1IsS0FBSyxFQUFFRyxZQUFZLEVBQUVqQixNQUFNLEVBQUU7RUFDbkRpQixZQUFZLENBQUNPLFdBQVcsR0FBR1YsS0FBSyxDQUFDVyxpQkFBaUI7RUFDbERSLFlBQVksQ0FBQ1MsU0FBUyxDQUFDQyxHQUFHLENBQUMzQixNQUFNLENBQUM0QixVQUFVLENBQUM7QUFDL0M7QUFFQSxTQUFTTCxjQUFjQSxDQUFDVCxLQUFLLEVBQUVkLE1BQU0sRUFBRTtFQUNyQyxJQUFNaUIsWUFBWSxHQUFHSCxLQUFLLENBQUNJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQ1AsYUFBYSxDQUFDWCxNQUFNLENBQUNtQixhQUFhLENBQUM7RUFDL0VGLFlBQVksQ0FBQ08sV0FBVyxHQUFHLEVBQUU7RUFDN0JQLFlBQVksQ0FBQ1MsU0FBUyxDQUFDRyxNQUFNLENBQUM3QixNQUFNLENBQUM0QixVQUFVLENBQUM7QUFDbEQ7QUFFTyxTQUFTZixpQkFBaUJBLENBQUNMLE1BQU0sRUFBRXNCLE1BQU0sRUFBRTlCLE1BQU0sRUFBRTtFQUN4RCxJQUFNK0IsT0FBTyxHQUFHQyxLQUFLLENBQUNDLElBQUksQ0FBQ3pCLE1BQU0sQ0FBQyxDQUFDMEIsS0FBSyxDQUFDLFVBQUNwQixLQUFLO0lBQUEsT0FBS0EsS0FBSyxDQUFDTSxRQUFRLENBQUNDLEtBQUs7RUFBQSxFQUFDO0VBQ3pFLElBQUlVLE9BQU8sRUFBRTtJQUNYRCxNQUFNLENBQUNKLFNBQVMsQ0FBQ0csTUFBTSxDQUFDN0IsTUFBTSxDQUFDbUMsbUJBQW1CLENBQUM7SUFDbkRMLE1BQU0sQ0FBQ00sUUFBUSxHQUFHLEtBQUs7RUFDekIsQ0FBQyxNQUFNO0lBQ0xOLE1BQU0sQ0FBQ0osU0FBUyxDQUFDQyxHQUFHLENBQUMzQixNQUFNLENBQUNtQyxtQkFBbUIsQ0FBQztJQUNoREwsTUFBTSxDQUFDTSxRQUFRLEdBQUcsSUFBSTtFQUN4QjtBQUNGO0FBRU8sU0FBU0MsZUFBZUEsQ0FBQy9CLElBQUksRUFBRU4sTUFBTSxFQUFFO0VBQzVDLElBQU1RLE1BQU0sR0FBR0YsSUFBSSxDQUFDSCxnQkFBZ0IsQ0FBQ0gsTUFBTSxDQUFDUyxhQUFhLENBQUM7RUFDMURELE1BQU0sQ0FBQ0gsT0FBTyxDQUFDLFVBQUNTLEtBQUs7SUFBQSxPQUFLUyxjQUFjLENBQUNULEtBQUssRUFBRWQsTUFBTSxDQUFDO0VBQUEsRUFBQztFQUN4RGEsaUJBQWlCLENBQUNMLE1BQU0sRUFBRUYsSUFBSSxDQUFDSyxhQUFhLENBQUNYLE1BQU0sQ0FBQ1ksb0JBQW9CLENBQUMsRUFBRVosTUFBTSxDQUFDO0FBQ3BGOzs7Ozs7OztBQ3REcUI7QUFDMkU7QUFFaEdFLFFBQVEsQ0FBQ2EsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsWUFBTTtFQUNsRCxJQUFNdUIsZ0JBQWdCLEdBQUc7SUFDdkJsQyxZQUFZLEVBQUUsTUFBTTtJQUNwQkssYUFBYSxFQUFFLGVBQWU7SUFDOUJHLG9CQUFvQixFQUFFLG9CQUFvQjtJQUMxQ3VCLG1CQUFtQixFQUFFLDRCQUE0QjtJQUNqRFAsVUFBVSxFQUFFLHNCQUFzQjtJQUNsQ1QsYUFBYSxFQUFFO0VBQ2pCLENBQUM7RUFFRHBCLGdCQUFnQixDQUFDdUMsZ0JBQWdCLENBQUM7RUFFbEMsSUFBTUMsWUFBWSxHQUFHLENBQ25CO0lBQUVDLElBQUksRUFBRSxhQUFhO0lBQUVDLElBQUksRUFBRTtFQUEwSCxDQUFDLEVBQ3hKO0lBQUVELElBQUksRUFBRSxvQkFBb0I7SUFBRUMsSUFBSSxFQUFFO0VBQWtILENBQUMsRUFDdko7SUFBRUQsSUFBSSxFQUFFLGlCQUFpQjtJQUFFQyxJQUFJLEVBQUU7RUFBd0gsQ0FBQyxFQUMxSjtJQUFFRCxJQUFJLEVBQUUsMkRBQTJEO0lBQUVDLElBQUksRUFBRTtFQUEwSCxDQUFDLEVBQ3RNO0lBQUVELElBQUksRUFBRSwyQkFBMkI7SUFBRUMsSUFBSSxFQUFFO0VBQXlILENBQUMsRUFDcks7SUFBRUQsSUFBSSxFQUFFLGdCQUFnQjtJQUFFQyxJQUFJLEVBQUU7RUFBMEgsQ0FBQyxFQUMzSjtJQUFFRCxJQUFJLEVBQUUsb0JBQW9CO0lBQUVDLElBQUksRUFBRTtFQUE2SCxDQUFDLENBQ25LO0VBRUQsSUFBTUMsaUJBQWlCLEdBQUd4QyxRQUFRLENBQUNTLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQztFQUN0RSxJQUFNZ0MsYUFBYSxHQUFHekMsUUFBUSxDQUFDUyxhQUFhLENBQUMsbUJBQW1CLENBQUM7RUFDakUsSUFBTWlDLFNBQVMsR0FBRzFDLFFBQVEsQ0FBQ1MsYUFBYSxDQUFDLHFCQUFxQixDQUFDO0VBQy9ELElBQU1rQyxZQUFZLEdBQUczQyxRQUFRLENBQUNTLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQztFQUU5RCxJQUFNbUMsUUFBUSxHQUFHRixTQUFTLGFBQVRBLFNBQVMsdUJBQVRBLFNBQVMsQ0FBRWpDLGFBQWEsQ0FBQyxNQUFNLENBQUM7RUFDakQsSUFBTW9DLFdBQVcsR0FBR0YsWUFBWSxhQUFaQSxZQUFZLHVCQUFaQSxZQUFZLENBQUVsQyxhQUFhLENBQUMsTUFBTSxDQUFDO0VBRXZELElBQU1xQyxrQkFBa0IsR0FBRzlDLFFBQVEsQ0FBQ1MsYUFBYSxDQUFDLGdCQUFnQixDQUFDO0VBQ25FLElBQU1zQyx5QkFBeUIsR0FBRy9DLFFBQVEsQ0FBQ1MsYUFBYSxDQUFDLHVCQUF1QixDQUFDO0VBQ2pGLElBQU11QyxhQUFhLEdBQUdoRCxRQUFRLENBQUNTLGFBQWEsQ0FBQyxxQkFBcUIsQ0FBQztFQUNuRSxJQUFNd0Msb0JBQW9CLEdBQUdqRCxRQUFRLENBQUNTLGFBQWEsQ0FBQyw0QkFBNEIsQ0FBQztFQUVqRixJQUFNeUMsYUFBYSxHQUFHbEQsUUFBUSxDQUFDUyxhQUFhLENBQUMseUJBQXlCLENBQUM7RUFDdkUsSUFBTTBDLGFBQWEsR0FBR25ELFFBQVEsQ0FBQ1MsYUFBYSxDQUFDLHNCQUFzQixDQUFDO0VBQ3BFLElBQU0yQyxZQUFZLEdBQUdwRCxRQUFRLENBQUNTLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQztFQUM3RCxJQUFNNEMsUUFBUSxHQUFHckQsUUFBUSxDQUFDUyxhQUFhLENBQUMsY0FBYyxDQUFDO0VBRXZELElBQU02QyxZQUFZLEdBQUd0RCxRQUFRLENBQUNTLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQztFQUM3RCxJQUFNOEMsWUFBWSxHQUFHRCxZQUFZLGFBQVpBLFlBQVksdUJBQVpBLFlBQVksQ0FBRTdDLGFBQWEsQ0FBQyxlQUFlLENBQUM7RUFDakUsSUFBTStDLGNBQWMsR0FBR0YsWUFBWSxhQUFaQSxZQUFZLHVCQUFaQSxZQUFZLENBQUU3QyxhQUFhLENBQUMsaUJBQWlCLENBQUM7RUFFckUsU0FBU2dELFNBQVNBLENBQUNDLEtBQUssRUFBRTtJQUN4QixJQUFJQSxLQUFLLEVBQUU7TUFDVEEsS0FBSyxDQUFDbEMsU0FBUyxDQUFDQyxHQUFHLENBQUMsY0FBYyxDQUFDO01BQ25DekIsUUFBUSxDQUFDYSxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUU4QyxlQUFlLENBQUM7SUFDdkQ7RUFDRjtFQUVBLFNBQVNDLFVBQVVBLENBQUNGLEtBQUssRUFBRTtJQUN6QixJQUFJQSxLQUFLLEVBQUU7TUFDVEEsS0FBSyxDQUFDbEMsU0FBUyxDQUFDRyxNQUFNLENBQUMsY0FBYyxDQUFDO01BQ3RDM0IsUUFBUSxDQUFDNkQsbUJBQW1CLENBQUMsU0FBUyxFQUFFRixlQUFlLENBQUM7SUFDMUQ7RUFDRjtFQUVBLFNBQVNBLGVBQWVBLENBQUNHLEtBQUssRUFBRTtJQUM5QixJQUFJQSxLQUFLLENBQUNDLEdBQUcsS0FBSyxRQUFRLEVBQUU7TUFDMUIsSUFBTUMsV0FBVyxHQUFHaEUsUUFBUSxDQUFDUyxhQUFhLENBQUMsZUFBZSxDQUFDO01BQzNELElBQUl1RCxXQUFXLEVBQUVKLFVBQVUsQ0FBQ0ksV0FBVyxDQUFDO0lBQzFDO0VBQ0Y7RUFFQWhFLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsQ0FBQ0UsT0FBTyxDQUFDLFVBQUN5QixNQUFNLEVBQUs7SUFDakUsSUFBTThCLEtBQUssR0FBRzlCLE1BQU0sQ0FBQ1osT0FBTyxDQUFDLFFBQVEsQ0FBQztJQUN0QyxJQUFJMEMsS0FBSyxFQUFFO01BQ1Q5QixNQUFNLENBQUNmLGdCQUFnQixDQUFDLE9BQU8sRUFBRTtRQUFBLE9BQU0rQyxVQUFVLENBQUNGLEtBQUssQ0FBQztNQUFBLEVBQUM7SUFDM0Q7RUFDRixDQUFDLENBQUM7RUFFRjFELFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUNFLE9BQU8sQ0FBQyxVQUFDdUQsS0FBSyxFQUFLO0lBQ3JEQSxLQUFLLENBQUM3QyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsVUFBQ2lELEtBQUssRUFBSztNQUM3QyxJQUFJQSxLQUFLLENBQUNHLE1BQU0sS0FBS1AsS0FBSyxFQUFFO1FBQzFCRSxVQUFVLENBQUNGLEtBQUssQ0FBQztNQUNuQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGLFNBQVNRLGNBQWNBLENBQUNDLElBQUksRUFBRTtJQUM1QixJQUFJLENBQUNBLElBQUksQ0FBQzdCLElBQUksSUFBSSxDQUFDNkIsSUFBSSxDQUFDNUIsSUFBSSxFQUFFO01BQzVCLE9BQU8sSUFBSTtJQUNiO0lBRUEsSUFBTTZCLFdBQVcsR0FBR2hCLFlBQVksQ0FBQ2lCLE9BQU8sQ0FBQzVELGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQzZELFNBQVMsQ0FBQyxJQUFJLENBQUM7SUFDL0UsSUFBTUMsU0FBUyxHQUFHSCxXQUFXLENBQUMzRCxhQUFhLENBQUMsY0FBYyxDQUFDO0lBQzNELElBQU0rRCxTQUFTLEdBQUdKLFdBQVcsQ0FBQzNELGFBQWEsQ0FBQyxjQUFjLENBQUM7SUFDM0QsSUFBTWdFLFdBQVcsR0FBR0wsV0FBVyxDQUFDM0QsYUFBYSxDQUFDLGlCQUFpQixDQUFDO0lBQ2hFLElBQU1pRSxhQUFhLEdBQUdOLFdBQVcsQ0FBQzNELGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQztJQUVwRThELFNBQVMsQ0FBQ0ksR0FBRyxHQUFHUixJQUFJLENBQUM1QixJQUFJO0lBQ3pCZ0MsU0FBUyxDQUFDSyxHQUFHLEdBQUdULElBQUksQ0FBQzdCLElBQUk7SUFDekJrQyxTQUFTLENBQUNsRCxXQUFXLEdBQUc2QyxJQUFJLENBQUM3QixJQUFJO0lBRWpDaUMsU0FBUyxDQUFDMUQsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07TUFDeEMsSUFBSXlDLFlBQVksSUFBSUMsWUFBWSxJQUFJQyxjQUFjLEVBQUU7UUFDbERELFlBQVksQ0FBQ29CLEdBQUcsR0FBR1IsSUFBSSxDQUFDNUIsSUFBSTtRQUM1QmdCLFlBQVksQ0FBQ3FCLEdBQUcsR0FBR1QsSUFBSSxDQUFDN0IsSUFBSTtRQUM1QmtCLGNBQWMsQ0FBQ2xDLFdBQVcsR0FBRzZDLElBQUksQ0FBQzdCLElBQUk7UUFDdENtQixTQUFTLENBQUNILFlBQVksQ0FBQztNQUN6QjtJQUNGLENBQUMsQ0FBQztJQUVGbUIsV0FBVyxDQUFDNUQsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07TUFDMUM0RCxXQUFXLENBQUNqRCxTQUFTLENBQUNxRCxNQUFNLENBQUMseUJBQXlCLENBQUM7SUFDekQsQ0FBQyxDQUFDO0lBRUZILGFBQWEsQ0FBQzdELGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFNO01BQzVDdUQsV0FBVyxDQUFDekMsTUFBTSxDQUFDLENBQUM7SUFDdEIsQ0FBQyxDQUFDO0lBRUYsT0FBT3lDLFdBQVc7RUFDcEI7RUFFQSxTQUFTVSxnQkFBZ0JBLENBQUEsRUFBRztJQUMxQixJQUFNQyxjQUFjLEdBQUcsSUFBSUMsR0FBRyxDQUM1QkMsa0JBQUEsQ0FBSTVCLFFBQVEsQ0FBQ3BELGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxFQUFFaUYsR0FBRyxDQUFDLFVBQUNDLEdBQUc7TUFBQSxPQUFLQSxHQUFHLENBQUNSLEdBQUc7SUFBQSxFQUNyRSxDQUFDO0lBRUR0QyxZQUFZLENBQUNsQyxPQUFPLENBQUMsVUFBQ2lGLElBQUksRUFBSztNQUM3QixJQUFJLENBQUNMLGNBQWMsQ0FBQ00sR0FBRyxDQUFDRCxJQUFJLENBQUM3QyxJQUFJLENBQUMsRUFBRTtRQUNsQyxJQUFNNkIsV0FBVyxHQUFHRixjQUFjLENBQUNrQixJQUFJLENBQUM7UUFDeEMsSUFBSWhCLFdBQVcsRUFBRWYsUUFBUSxDQUFDaUMsT0FBTyxDQUFDbEIsV0FBVyxDQUFDO01BQ2hEO0lBQ0YsQ0FBQyxDQUFDO0VBQ0o7RUFFQVUsZ0JBQWdCLENBQUMsQ0FBQztFQUVsQmpDLFdBQVcsQ0FBQ2hDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxVQUFDMEUsR0FBRyxFQUFLO0lBQzlDQSxHQUFHLENBQUNDLGNBQWMsQ0FBQyxDQUFDO0lBRXBCLElBQU1sRCxJQUFJLEdBQUdZLGFBQWEsQ0FBQ3VDLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLENBQUM7SUFDdkMsSUFBTW5ELElBQUksR0FBR1ksYUFBYSxDQUFDc0MsS0FBSyxDQUFDQyxJQUFJLENBQUMsQ0FBQztJQUV2QyxJQUFJLENBQUNwRCxJQUFJLElBQUksQ0FBQ0MsSUFBSSxFQUFFO01BQ2xCO0lBQ0Y7SUFFQSxJQUFNb0QsUUFBUSxHQUFHO01BQUVyRCxJQUFJLEVBQUpBLElBQUk7TUFBRUMsSUFBSSxFQUFKQTtJQUFLLENBQUM7SUFDL0IsSUFBTTZCLFdBQVcsR0FBR0YsY0FBYyxDQUFDeUIsUUFBUSxDQUFDO0lBRTVDLElBQUl2QixXQUFXLEVBQUU7TUFDZmYsUUFBUSxDQUFDaUMsT0FBTyxDQUFDbEIsV0FBVyxDQUFDO0lBQy9CO0lBRUF2QixXQUFXLENBQUMrQyxLQUFLLENBQUMsQ0FBQztJQUVuQnpELGVBQWUsQ0FBQ1UsV0FBVyxFQUFFVCxnQkFBZ0IsQ0FBQztJQUU5Q3pCLGlCQUFpQixDQUNma0MsV0FBVyxDQUFDNUMsZ0JBQWdCLENBQUNtQyxnQkFBZ0IsQ0FBQzdCLGFBQWEsQ0FBQyxFQUM1RHNDLFdBQVcsQ0FBQ3BDLGFBQWEsQ0FBQzJCLGdCQUFnQixDQUFDMUIsb0JBQW9CLENBQUMsRUFDaEUwQixnQkFDRixDQUFDO0lBRUR3QixVQUFVLENBQUNqQixZQUFZLENBQUM7RUFDMUIsQ0FBQyxDQUFDO0VBRUYsSUFBSUgsaUJBQWlCLElBQUlFLFNBQVMsRUFBRTtJQUNsQ0YsaUJBQWlCLENBQUMzQixnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBTTtNQUNoRG1DLGFBQWEsQ0FBQ3lDLEtBQUssR0FBRzNDLGtCQUFrQixDQUFDeEIsV0FBVztNQUNwRDJCLG9CQUFvQixDQUFDd0MsS0FBSyxHQUFHMUMseUJBQXlCLENBQUN6QixXQUFXO01BQ2xFYSxlQUFlLENBQUNTLFFBQVEsRUFBRVIsZ0JBQWdCLENBQUM7TUFDM0NxQixTQUFTLENBQUNmLFNBQVMsQ0FBQztJQUN0QixDQUFDLENBQUM7RUFDSjtFQUVBLElBQUlFLFFBQVEsRUFBRTtJQUNaQSxRQUFRLENBQUMvQixnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsVUFBQzBFLEdBQUcsRUFBSztNQUMzQ0EsR0FBRyxDQUFDQyxjQUFjLENBQUMsQ0FBQztNQUNwQjFDLGtCQUFrQixDQUFDeEIsV0FBVyxHQUFHMEIsYUFBYSxDQUFDeUMsS0FBSyxDQUFDQyxJQUFJLENBQUMsQ0FBQztNQUMzRDNDLHlCQUF5QixDQUFDekIsV0FBVyxHQUFHMkIsb0JBQW9CLENBQUN3QyxLQUFLLENBQUNDLElBQUksQ0FBQyxDQUFDO01BQ3pFOUIsVUFBVSxDQUFDbEIsU0FBUyxDQUFDO0lBQ3ZCLENBQUMsQ0FBQztFQUNKO0VBRUEsSUFBSUQsYUFBYSxJQUFJRSxZQUFZLEVBQUU7SUFDakNGLGFBQWEsQ0FBQzVCLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFNO01BQzVDc0IsZUFBZSxDQUFDVSxXQUFXLEVBQUVULGdCQUFnQixDQUFDO01BQzlDcUIsU0FBUyxDQUFDZCxZQUFZLENBQUM7SUFDekIsQ0FBQyxDQUFDO0VBQ0o7QUFDRixDQUFDLENBQUMsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oY29uZmlnKSB7XHJcbiAgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1zLmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm0sIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldEV2ZW50TGlzdGVuZXJzKGZvcm0sIGNvbmZpZykge1xyXG4gIGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3Rvcik7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRzLCBzdWJtaXRCdXR0b24sIGNvbmZpZyk7XHJcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICB2YWxpZGF0ZUlucHV0KGlucHV0LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dHMsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUlucHV0KGlucHV0LCBjb25maWcpIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBpbnB1dC5jbG9zZXN0KFwibGFiZWxcIikucXVlcnlTZWxlY3Rvcihjb25maWcuZXJyb3JTZWxlY3Rvcik7XHJcbiAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoaW5wdXQsIGNvbmZpZyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50LCBjb25maWcpIHtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JDbGFzcyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVJbnB1dEVycm9yKGlucHV0LCBjb25maWcpIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBpbnB1dC5jbG9zZXN0KFwibGFiZWxcIikucXVlcnlTZWxlY3Rvcihjb25maWcuZXJyb3JTZWxlY3Rvcik7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dHMsIGJ1dHRvbiwgY29uZmlnKSB7XHJcbiAgY29uc3QgaXNWYWxpZCA9IEFycmF5LmZyb20oaW5wdXRzKS5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuICBpZiAoaXNWYWxpZCkge1xyXG4gICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRWYWxpZGF0aW9uKGZvcm0sIGNvbmZpZykge1xyXG4gIGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3Rvcik7XHJcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiBoaWRlSW5wdXRFcnJvcihpbnB1dCwgY29uZmlnKSk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRzLCBmb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKSwgY29uZmlnKTtcclxufSIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHJlc2V0VmFsaWRhdGlvbiwgdG9nZ2xlQnV0dG9uU3RhdGUgfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCJmb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gICAgZXJyb3JTZWxlY3RvcjogXCIubW9kYWxfX2Vycm9yXCIsXHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbiAgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAgeyBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIiB9LFxyXG4gICAgeyBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLCBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiIH0sXHJcbiAgICB7IG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIgfSxcclxuICAgIHsgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIiwgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiIH0sXHJcbiAgICB7IG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLCBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIiB9LFxyXG4gICAgeyBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIiB9LFxyXG4gICAgeyBuYW1lOiBcIkdvbGRlbiBHYXRlIGJyaWRnZVwiLCBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIgfVxyXG4gIF07XHJcblxyXG4gIGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuICBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG4gIGNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG4gIGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcblxyXG4gIGNvbnN0IGVkaXRGb3JtID0gZWRpdE1vZGFsPy5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcclxuICBjb25zdCBhZGRDYXJkRm9ybSA9IGFkZENhcmRNb2RhbD8ucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XHJcblxyXG4gIGNvbnN0IHByb2ZpbGVOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuICBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuICBjb25zdCBlZGl0TmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbiAgY29uc3QgZWRpdERlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XHJcblxyXG4gIGNvbnN0IGNhcmROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWNhcHRpb24taW5wdXRcIik7XHJcbiAgY29uc3QgY2FyZExpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbiAgY29uc3QgY2FyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuICBjb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbiAgY29uc3QgcHJldmlld0ltYWdlID0gcHJldmlld01vZGFsPy5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICBjb25zdCBwcmV2aWV3Q2FwdGlvbiA9IHByZXZpZXdNb2RhbD8ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuXHJcbiAgZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgICBpZiAobW9kYWwpIHtcclxuICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICAgIGlmIChtb2RhbCkge1xyXG4gICAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlRXNjYXBlS2V5KGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICAgIGlmIChvcGVuZWRNb2RhbCkgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIikuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgICBjb25zdCBtb2RhbCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xyXG4gICAgaWYgKG1vZGFsKSB7XHJcbiAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCkpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBtb2RhbCkge1xyXG4gICAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gICAgaWYgKCFkYXRhLm5hbWUgfHwgIWRhdGEubGluaykge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNvbnN0IGNhcmRsaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuICAgIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XHJcblxyXG4gICAgY2FyZEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIGNhcmRJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcblxyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmIChwcmV2aWV3TW9kYWwgJiYgcHJldmlld0ltYWdlICYmIHByZXZpZXdDYXB0aW9uKSB7XHJcbiAgICAgICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgICAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBjYXJkbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gbG9hZEluaXRpYWxDYXJkcygpIHtcclxuICAgIGNvbnN0IGV4aXN0aW5nSW1hZ2VzID0gbmV3IFNldChcclxuICAgICAgWy4uLmNhcmRMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FyZF9faW1hZ2VcIildLm1hcCgoaW1nKSA9PiBpbWcuc3JjKVxyXG4gICAgKTtcclxuXHJcbiAgICBpbml0aWFsQ2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICBpZiAoIWV4aXN0aW5nSW1hZ2VzLmhhcyhjYXJkLmxpbmspKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcclxuICAgICAgICBpZiAoY2FyZEVsZW1lbnQpIGNhcmRMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxvYWRJbml0aWFsQ2FyZHMoKTtcclxuXHJcbiAgYWRkQ2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCBuYW1lID0gY2FyZE5hbWVJbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgICBjb25zdCBsaW5rID0gY2FyZExpbmtJbnB1dC52YWx1ZS50cmltKCk7XHJcblxyXG4gICAgaWYgKCFuYW1lIHx8ICFsaW5rKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjYXJkRGF0YSA9IHsgbmFtZSwgbGluayB9O1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XHJcblxyXG4gICAgaWYgKGNhcmRFbGVtZW50KSB7XHJcbiAgICAgIGNhcmRMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENhcmRGb3JtLnJlc2V0KCk7XHJcblxyXG4gICAgcmVzZXRWYWxpZGF0aW9uKGFkZENhcmRGb3JtLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZShcclxuICAgICAgYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgICBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpLFxyXG4gICAgICB2YWxpZGF0aW9uQ29uZmlnXHJcbiAgICApO1xyXG5cclxuICAgIGNsb3NlTW9kYWwoYWRkQ2FyZE1vZGFsKTtcclxuICB9KTtcclxuXHJcbiAgaWYgKGVkaXRQcm9maWxlQnV0dG9uICYmIGVkaXRNb2RhbCkge1xyXG4gICAgZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgZWRpdE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudDtcclxuICAgICAgZWRpdERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50O1xyXG4gICAgICByZXNldFZhbGlkYXRpb24oZWRpdEZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaWYgKGVkaXRGb3JtKSB7XHJcbiAgICBlZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGVkaXROYW1lSW5wdXQudmFsdWUudHJpbSgpO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZWRpdERlc2NyaXB0aW9uSW5wdXQudmFsdWUudHJpbSgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGlmIChhZGRDYXJkQnV0dG9uICYmIGFkZENhcmRNb2RhbCkge1xyXG4gICAgYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICByZXNldFZhbGlkYXRpb24oYWRkQ2FyZEZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgICBvcGVuTW9kYWwoYWRkQ2FyZE1vZGFsKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcbiJdLCJuYW1lcyI6WyJlbmFibGVWYWxpZGF0aW9uIiwiY29uZmlnIiwiZm9ybXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JtU2VsZWN0b3IiLCJmb3JFYWNoIiwiZm9ybSIsInNldEV2ZW50TGlzdGVuZXJzIiwiaW5wdXRzIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwidmFsaWRhdGVJbnB1dCIsImVycm9yRWxlbWVudCIsImNsb3Nlc3QiLCJlcnJvclNlbGVjdG9yIiwidmFsaWRpdHkiLCJ2YWxpZCIsInNob3dJbnB1dEVycm9yIiwiaGlkZUlucHV0RXJyb3IiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZXJyb3JDbGFzcyIsInJlbW92ZSIsImJ1dHRvbiIsImlzVmFsaWQiLCJBcnJheSIsImZyb20iLCJldmVyeSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsInJlc2V0VmFsaWRhdGlvbiIsInZhbGlkYXRpb25Db25maWciLCJpbml0aWFsQ2FyZHMiLCJuYW1lIiwibGluayIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsImVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50IiwiZWRpdE5hbWVJbnB1dCIsImVkaXREZXNjcmlwdGlvbklucHV0IiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJjYXJkVGVtcGxhdGUiLCJjYXJkTGlzdCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdJbWFnZSIsInByZXZpZXdDYXB0aW9uIiwib3Blbk1vZGFsIiwibW9kYWwiLCJoYW5kbGVFc2NhcGVLZXkiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Iiwib3BlbmVkTW9kYWwiLCJ0YXJnZXQiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJjYXJkbGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJzcmMiLCJhbHQiLCJ0b2dnbGUiLCJsb2FkSW5pdGlhbENhcmRzIiwiZXhpc3RpbmdJbWFnZXMiLCJTZXQiLCJfdG9Db25zdW1hYmxlQXJyYXkiLCJtYXAiLCJpbWciLCJjYXJkIiwiaGFzIiwicHJlcGVuZCIsImV2dCIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJ0cmltIiwiY2FyZERhdGEiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=